<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Quiz App</title>
</head>
<body>
  <h1>Quiz App</h1>
  <div id="questions-container"></div>

  <script>
    async function fetchAllQuestions() {
      try {
        const response = await fetch('http://localhost:3000/api/v1/questions/');
        const data = await response.json();
        displayQuestions(data);
      } catch (error) {
        console.error('Error fetching questions:', error);
      }
    }

    function displayQuestions(questions) {
      const questionsContainer = document.getElementById('questions-container');
      questionsContainer.innerHTML = '';

      questions.forEach(question => {
        const questionElement = document.createElement('div');
        questionElement.innerHTML = `
          <p>${question.question}</p>
          <form>
            ${question.options.map(option => `
              <input type="radio" name="answer" value="${option}">
              <label>${option}</label><br>
            `).join('')}
            <button type="button" onclick="checkAnswer('${question._id}')">Submit</button>
            <p id="feedback-${question._id}"></p>
          </form>
        `;
        questionsContainer.appendChild(questionElement);
      });
    }

    async function checkAnswer(questionId) {
      const selectedAnswer = document.querySelector(`input[name="answer"]:checked`);
      if (!selectedAnswer) {
        alert('Please select an answer.');
        return;
      }

      const answer = selectedAnswer.value;
      try {
        const response = await fetch('http://localhost:3000/api/v1/check-answer', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json'
          },
          body: JSON.stringify({
            _id: questionId,
            selectedAnswer: answer
          })
        });
        const result = await response.json();
        const feedbackElement = document.getElementById(`feedback-${questionId}`);
        if (result.isCorrect) {
          feedbackElement.textContent = 'Correct!';
        } else {
          feedbackElement.textContent = `Incorrect. The correct answer is: ${result.correctAnswer}`;
        }
      } catch (error) {
        console.error('Error checking answer:', error);
      }
    }

    fetchAllQuestions();
  </script>
</body>
</html>
